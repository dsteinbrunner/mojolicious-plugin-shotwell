NAME
    Mojolicious::Plugin::Shotwell - View photos from Shotwell database

VERSION
    0.01

SYNOPSIS
      use Mojolicious::Lite;

      # allow /shotwell/... resources to be protected by login
      my $route = under '/shotwell' => sub {
        my $c = shift;
        return 1 if $c->session('username');
        $c->render('login');
        return 0;
      };

      plugin shotwell => {
        dbname => '/home/username/.local/share/shotwell/data/photo.db',
        route => $route,
      };

      app->start;

DESCRIPTION
    This plugin provides actions which can render data from a Shotwell
    <http://www.yorba.org/projects/shotwell> database:

    *   Events

        See "events" and "event".

    *   Tags

        See "tags" and "tag".

    *   Thumbnails

        See "thumb".

    *   Photos

        See "show" and "raw".

ATTRIBUTES
  dsn
    Returns argument for "connect" in DBI. Default is

      dbi:SQLite:dbname=$HOME/.local/share/shotwell/data/photo.db

    $HOME is either the "SHOTWELL_HOME" or "HOME" environment variable. The
    default attribute can be overridden by either giving "dsn" or "dbname"
    to "register". Example:

      $self->register($app, { dbname => $path_to_db_file });

  paths
    Holds a hash ref with route mappings. Default is:

      events => '/'
      event  => '/event/:id/:name'
      tags   => '/tags'
      tag    => '/tag/:name'
      raw    => '/raw/:id/*basename'
      show   => '/show/:id/*basename'
      thumb  => '/thumb/:id/*basename'

    Any of the above routes can be overridden by passing on paths to
    "register", but remember that the placeholders are required in the
    "ACTIONS". Example:

      $self->register(
        $app,
        {
          paths => {
            events => '/events',
            ...
          },
        },
      );

ACTIONS
  events
    Render data from EventTable. Data is rendered as JSON or defaults to a
    template by the name "templates/shotwell/events.html.ep".

    JSON data:

      [
        {
          id => $int,
          name => $str,
          time_created => $epoch,
          url => $shotwell_event_url,
        },
        ...
      ]

    The JSON data is also available in the template as $events.

  event
    Render photos from PhotoTable, by a given event id. Data is rendered as
    JSON or defaults to a template by the name
    "templates/shotwell/event.html.ep".

    JSON data:

      [
        {
          id => $int,
          size => $int,
          title => $str,
          raw => $shotwell_raw_url,
          thumb => $shotwell_thumb_url,
          url => $shotwell_show_url,
        },
        ...
      ]

    The JSON data is also available in the template as $photos.

  tags
    Render data from TagTable. Data is rendered as JSON or defaults to a
    template by the name "templates/shotwell/tags.html.ep".

    JSON data:

      [
        {
          name => $str,
          url => $shotwell_tag_url,
        },
        ...
      ]

    The JSON data is also available in the template as $tags.

  tag
    Render photos from PhotoTable, by a given tag name. Data is rendered as
    JSON or defaults to a template by the name
    "templates/shotwell/tag.html.ep".

    The JSON data is the same as for "event".

  raw
    Render raw photo.

  show
    Render a template with an photo inside. The name of the template is
    "templates/shotwell/show.html.ep".

    The stash data is the same as one element described for "event" JSON
    data.

  thumb
    Render photo as a thumbnail.

METHODS
  register
      $self->register($app, \%config);

    Set "ATTRIBUTES" and register "ACTIONS" in the Mojolicious application.

DATABASE SCHEME
  EventTable
      id INTEGER PRIMARY KEY,
      name TEXT,
      primary_photo_id INTEGER,
      time_created INTEGER,primary_source_id TEXT,
      comment TEXT

  PhotoTable
      id INTEGER PRIMARY KEY,
      filename TEXT UNIQUE NOT NULL,
      width INTEGER,
      height INTEGER,
      filesize INTEGER,
      timestamp INTEGER,
      exposure_time INTEGER,
      orientation INTEGER,
      original_orientation INTEGER,
      import_id INTEGER,
      event_id INTEGER,
      transformations TEXT,
      md5 TEXT,
      thumbnail_md5 TEXT,
      exif_md5 TEXT,
      time_created INTEGER,
      flags INTEGER DEFAULT 0,
      rating INTEGER DEFAULT 0,
      file_format INTEGER DEFAULT 0,
      title TEXT,
      backlinks TEXT,
      time_reimported INTEGER,
      editable_id INTEGER DEFAULT -1,
      metadata_dirty INTEGER DEFAULT 0,
      developer TEXT,
      develop_shotwell_id INTEGER DEFAULT -1,
      develop_camera_id INTEGER DEFAULT -1,
      develop_embedded_id INTEGER DEFAULT -1,
      comment TEXT

  TagTable
      id INTEGER PRIMARY KEY,
      name TEXT UNIQUE NOT NULL,
      photo_id_list TEXT,
      time_created INTEGER

AUTHOR
    Jan Henning Thorsen - "jhthorsen@cpan.org"

